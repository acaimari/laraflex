var threeSixtyPlayer,ThreeSixtyPlayer;
!function(g){function x(){var a=this,c=this,h=soundManager,n=navigator.userAgent,u=n.match(/msie/i),l=n.match(/opera/i),k=n.match(/safari/i),r=n.match(/chrome/i),p=(n.match(/firefox/i),n.match(/ipad|iphone/i)),v="undefined"==typeof g.G_vmlCanvasManager&&"undefined"!=typeof document.createElement("canvas").getContext("2d"),m=l||r?359.9:360,A=navigator.userAgent.match(/msie [678]/i)?1:2;this.excludeClass="threesixty-exclude";this.links=[];this.sounds=[];this.soundsByURL=[];this.indexByURL=[];this.lastTouchedSound=
this.lastSound=null;this.soundCount=0;this.vuMeter=this.oUIImageMap=this.oUITemplate=null;this.callbackCount=0;this.peakDataHistory=[];this.config={playNext:!1,autoPlay:!1,allowMultiple:!1,loadRingColor:"#ccc",playRingColor:"#000",backgroundRingColor:"#eee",segmentRingColor:"rgba(255,255,255,0.33)",segmentRingColorAlt:"rgba(0,0,0,0.1)",loadRingColorMetadata:"#ddd",playRingColorMetadata:"rgba(128,192,256,0.9)",circleDiameter:null,circleRadius:null,animDuration:500,animTransition:g.Animator.tx.bouncy,
showHMSTime:!1,scaleFont:!0,useWaveformData:!1,waveformDataColor:"#0099ff",waveformDataDownsample:3,waveformDataOutside:!1,waveformDataConstrain:!1,waveformDataLineRatio:.64,useEQData:!1,eqDataColor:"#339933",eqDataDownsample:4,eqDataOutside:!0,eqDataLineRatio:.54,usePeakData:!0,peakDataColor:"#ff33ff",peakDataOutside:!0,peakDataLineRatio:.5,useAmplifier:!0,fontSizeMax:null,scaleArcWidth:1,useFavIcon:!1};this.css={sDefault:"sm2_link",sBuffering:"sm2_buffering",sPlaying:"sm2_playing",sPaused:"sm2_paused"};
this.addEventHandler="undefined"!=typeof g.addEventListener?function(b,a,f){return b.addEventListener(a,f,!1)}:function(b,a,f){b.attachEvent("on"+a,f)};this.removeEventHandler="undefined"!=typeof g.removeEventListener?function(b,a,f){return b.removeEventListener(a,f,!1)}:function(b,a,f){return b.detachEvent("on"+a,f)};this.hasClass=function(b,a){return"undefined"!=typeof b.className?b.className.match(new RegExp("(\\s|^)"+a+"(\\s|$)")):!1};this.addClass=function(b,d){return b&&d&&!a.hasClass(b,d)?
void(b.className=(b.className?b.className+" ":"")+d):!1};this.removeClass=function(b,d){return b&&d&&a.hasClass(b,d)?void(b.className=b.className.replace(new RegExp("( "+d+")|("+d+")","g"),"")):!1};this.getElementsByClassName=function(b,d,f){var e;e=f||document;var k=[],c=[];if("undefined"!=typeof d&&"string"!=typeof d)for(f=d.length;f--;)c&&c[d[f]]||(c[d[f]]=e.getElementsByTagName(d[f]));else c=d?e.getElementsByTagName(d):e.all||e.getElementsByTagName("*");if("string"!=typeof d)for(f=d.length;f--;)for(e=
c[d[f]].length;e--;)a.hasClass(c[d[f]][e],b)&&k.push(c[d[f]][e]);else for(f=0;f<c.length;f++)a.hasClass(c[f],b)&&k.push(c[f]);return k};this.getParentByNodeName=function(b,a){if(!b||!a)return!1;for(a=a.toLowerCase();b.parentNode&&a!==b.parentNode.nodeName.toLowerCase();)b=b.parentNode;return b.parentNode&&a===b.parentNode.nodeName.toLowerCase()?b.parentNode:null};this.getParentByClassName=function(b,d){if(!b||!d)return!1;for(;b.parentNode&&!a.hasClass(b.parentNode,d);)b=b.parentNode;return b.parentNode&&
a.hasClass(b.parentNode,d)?b.parentNode:null};this.getSoundByURL=function(b){return"undefined"!=typeof a.soundsByURL[b]?a.soundsByURL[b]:null};this.isChildOfNode=function(b,a){if(!b||!b.parentNode)return!1;a=a.toLowerCase();do b=b.parentNode;while(b&&b.parentNode&&b.nodeName.toLowerCase()!==a);return b&&b.nodeName.toLowerCase()===a?b:null};this.isChildOfClass=function(b,d){if(!b||!d)return!1;for(;b.parentNode&&!a.hasClass(b,d);)b=a.findParent(b);return a.hasClass(b,d)};this.findParent=function(b){if(!b||
!b.parentNode)return!1;if(b=b.parentNode,2===b.nodeType)for(;b&&b.parentNode&&2===b.parentNode.nodeType;)b=b.parentNode;return b};this.getStyle=function(b,a){try{if(b.currentStyle)return b.currentStyle[a];if(g.getComputedStyle)return document.defaultView.getComputedStyle(b,null).getPropertyValue(a)}catch(f){}return null};this.findXY=function(b){var a=0,f=0;do a+=b.offsetLeft,f+=b.offsetTop;while(b=b.offsetParent);return[a,f]};this.getMouseXY=function(b){return b=b?b:g.event,p&&b.touches&&(b=b.touches[0]),
b.pageX||b.pageY?[b.pageX,b.pageY]:b.clientX||b.clientY?[b.clientX+a.getScrollLeft(),b.clientY+a.getScrollTop()]:void 0};this.getScrollLeft=function(){return document.body.scrollLeft+document.documentElement.scrollLeft};this.getScrollTop=function(){return document.body.scrollTop+document.documentElement.scrollTop};this.events={play:function(){c.removeClass(this._360data.oUIBox,this._360data.className);this._360data.className=c.css.sPlaying;c.addClass(this._360data.oUIBox,this._360data.className);
a.fanOut(this)},stop:function(){c.removeClass(this._360data.oUIBox,this._360data.className);this._360data.className="";a.fanIn(this)},pause:function(){c.removeClass(this._360data.oUIBox,this._360data.className);this._360data.className=c.css.sPaused;c.addClass(this._360data.oUIBox,this._360data.className)},resume:function(){c.removeClass(this._360data.oUIBox,this._360data.className);this._360data.className=c.css.sPlaying;c.addClass(this._360data.oUIBox,this._360data.className)},finish:function(){var b;
c.removeClass(this._360data.oUIBox,this._360data.className);this._360data.className="";this._360data.didFinish=!0;a.fanIn(this);c.config.playNext&&(b=c.indexByURL[this._360data.oLink.href]+1,b<c.links.length&&c.handleClick({target:c.links[b]}))},whileloading:function(){this.paused&&a.updatePlaying.apply(this)},whileplaying:function(){a.updatePlaying.apply(this);this._360data.fps++},bufferchange:function(){this.isBuffering?c.addClass(this._360data.oUIBox,c.css.sBuffering):c.removeClass(this._360data.oUIBox,
c.css.sBuffering)}};this.stopEvent=function(b){return"undefined"!=typeof b&&"undefined"!=typeof b.preventDefault?b.preventDefault():"undefined"!=typeof g.event&&"undefined"!=typeof g.event.returnValue&&(g.event.returnValue=!1),!1};this.getTheDamnLink=u?function(b){return b&&b.target?b.target:g.event.srcElement}:function(b){return b.target};this.handleClick=function(b){if(1<b.button)return!0;var d,f,e,c,k,l,q=a.getTheDamnLink(b);return("a"===q.nodeName.toLowerCase()||(q=a.isChildOfNode(q,"a")))&&a.isChildOfClass(q,
"ui360")?(q.getAttribute("href"),q.href&&h.canPlayLink(q)&&!a.hasClass(q,a.excludeClass)?(h._writeDebug("handleClick()"),f=q.href,e=a.getSoundByURL(f),e?e===a.lastSound?e.togglePause():(e.togglePause(),h._writeDebug("sound different than last sound: "+a.lastSound.id),!a.config.allowMultiple&&a.lastSound&&a.stopSound(a.lastSound)):(c=q.parentNode,k=a.getElementsByClassName("ui360-vis","div",c.parentNode).length,e=h.createSound({id:"ui360Sound"+a.soundCount++,url:f,onplay:a.events.play,onstop:a.events.stop,
onpause:a.events.pause,onresume:a.events.resume,onfinish:a.events.finish,onbufferchange:a.events.bufferchange,type:q.type||null,whileloading:a.events.whileloading,whileplaying:a.events.whileplaying,useWaveformData:k&&a.config.useWaveformData,useEQData:k&&a.config.useEQData,usePeakData:k&&a.config.usePeakData}),l=parseInt(a.getElementsByClassName("sm2-360ui","div",c)[0].offsetWidth*A,10),d=a.getElementsByClassName("sm2-canvas","canvas",c),e._360data={oUI360:a.getParentByClassName(q,"ui360"),oLink:q,
className:a.css.sPlaying,oUIBox:a.getElementsByClassName("sm2-360ui","div",c)[0],oCanvas:d[d.length-1],oButton:a.getElementsByClassName("sm2-360btn","span",c)[0],oTiming:a.getElementsByClassName("sm2-timing","div",c)[0],oCover:a.getElementsByClassName("sm2-cover","div",c)[0],circleDiameter:l,circleRadius:l/2,lastTime:null,didFinish:null,pauseCount:0,radius:0,fontSize:1,fontSizeMax:a.config.fontSizeMax,scaleFont:k&&a.config.scaleFont,showHMSTime:k,amplifier:k&&a.config.usePeakData?.9:1,radiusMax:.175*
l,width:0,widthMax:.4*l,lastValues:{bytesLoaded:0,bytesTotal:0,position:0,durationEstimate:0},animating:!1,oAnim:new g.Animator({duration:a.config.animDuration,transition:a.config.animTransition,onComplete:function(){}}),oAnimProgress:function(b){this._360data.radius=parseInt(this._360data.radiusMax*this._360data.amplifier*b,10);this._360data.width=parseInt(this._360data.widthMax*this._360data.amplifier*b,10);this._360data.scaleFont&&null!==this._360data.fontSizeMax&&(this._360data.oTiming.style.fontSize=
parseInt(Math.max(1,this._360data.fontSizeMax*b),10)+"px",this._360data.oTiming.style.opacity=b);(this.paused||0===this.playState||0===this._360data.lastValues.bytesLoaded||0===this._360data.lastValues.position)&&a.updatePlaying.apply(this)},fps:0},"undefined"!=typeof a.Metadata&&a.getElementsByClassName("metadata","div",e._360data.oUI360).length&&(e._360data.metadata=new a.Metadata(e,a)),e._360data.scaleFont&&null!==e._360data.fontSizeMax&&(e._360data.oTiming.style.fontSize="1px"),e._360data.oAnim.addSubject(e._360data.oAnimProgress,
e),a.refreshCoords(e),a.updatePlaying.apply(e),a.soundsByURL[f]=e,a.sounds.push(e),!a.config.allowMultiple&&a.lastSound&&a.stopSound(a.lastSound),e.play()),a.lastSound=e,"undefined"!=typeof b&&"undefined"!=typeof b.preventDefault?b.preventDefault():"undefined"!=typeof g.event&&(g.event.returnValue=!1),!1):!0):!0};this.fanOut=function(b){return 1===b._360data.animating?!1:(b._360data.animating=0,soundManager._writeDebug("fanOut: "+b.id+": "+b._360data.oLink.href),b._360data.oAnim.seekTo(1),void g.setTimeout(function(){b._360data.animating=
0},a.config.animDuration+20))};this.fanIn=function(b){return-1===b._360data.animating?!1:(b._360data.animating=-1,soundManager._writeDebug("fanIn: "+b.id+": "+b._360data.oLink.href),b._360data.oAnim.seekTo(0),void g.setTimeout(function(){b._360data.didFinish=!1;b._360data.animating=0;a.resetLastValues(b)},a.config.animDuration+20))};this.resetLastValues=function(b){b._360data.lastValues.position=0};this.refreshCoords=function(b){b._360data.canvasXY=a.findXY(b._360data.oCanvas);b._360data.canvasMid=
[b._360data.circleRadius,b._360data.circleRadius];b._360data.canvasMidXY=[b._360data.canvasXY[0]+b._360data.canvasMid[0],b._360data.canvasXY[1]+b._360data.canvasMid[1]]};this.stopSound=function(b){soundManager._writeDebug("stopSound: "+b.id);soundManager.stop(b.id);p||soundManager.unload(b.id)};this.buttonClick=function(b){return a.handleClick({target:a.getParentByClassName(b?b.target?b.target:b.srcElement:g.event.srcElement,"sm2-360ui").nextSibling}),!1};this.buttonMouseDown=function(b){return p?
a.addEventHandler(document,"touchmove",a.mouseDown):document.onmousemove=function(b){a.mouseDown(b)},a.stopEvent(b),!1};this.mouseDown=function(b){if(!p&&1<b.button)return!0;if(!a.lastSound)return a.stopEvent(b),!1;var d,f,e,c=b?b:g.event;return p&&c.touches&&(c=c.touches[0]),d=c.target||c.srcElement,f=a.getSoundByURL(a.getElementsByClassName("sm2_link","a",a.getParentByClassName(d,"ui360"))[0].href),a.lastTouchedSound=f,a.refreshCoords(f),e=f._360data,a.addClass(e.oUIBox,"sm2_dragging"),e.pauseCount=
a.lastTouchedSound.paused?1:0,a.mmh(b?b:g.event),p?(a.removeEventHandler(document,"touchmove",a.mouseDown),a.addEventHandler(document,"touchmove",a.mmh),a.addEventHandler(document,"touchend",a.mouseUp)):(document.onmousemove=a.mmh,document.onmouseup=a.mouseUp),a.stopEvent(b),!1};this.mouseUp=function(b){b=a.lastTouchedSound._360data;a.removeClass(b.oUIBox,"sm2_dragging");0===b.pauseCount&&a.lastTouchedSound.resume();p?(a.removeEventHandler(document,"touchmove",a.mmh),a.removeEventHandler(document,
"touchend",a.mouseUP)):(document.onmousemove=null,document.onmouseup=null)};this.mmh=function(b){"undefined"==typeof b&&(b=g.event);var d=a.lastTouchedSound,f=a.getMouseXY(b),f=Math.floor(m-(a.rad2deg(Math.atan2(f[0]-d._360data.canvasMidXY[0],f[1]-d._360data.canvasMidXY[1]))+180));return d.setPosition(f/m*d.durationEstimate),a.stopEvent(b),!1};this.drawSolidArc=function(b,d,f,e,c,h,g){var q,p,r=b;r.getContext&&(q=r.getContext("2d"));b=q;g||a.clearCanvas(r);d&&(q.fillStyle=d);b.beginPath();isNaN(c)&&
(c=0);d=f-e;e=l||k;(!e||e&&0<f)&&(b.arc(0,0,f,h,c,!1),p=a.getArcEndpointCoords(d,c),b.lineTo(p.x,p.y),b.arc(0,0,d,c,h,!0),b.closePath(),b.fill())};this.getArcEndpointCoords=function(b,a){return{x:b*Math.cos(a),y:b*Math.sin(a)}};this.deg2rad=function(b){return b*Math.PI/180};this.rad2deg=function(b){return 180*b/Math.PI};this.getTime=function(b,a){var f=Math.floor(b/1E3),e=Math.floor(f/60),f=f-60*e;return a?e+":"+(10>f?"0"+f:f):{min:e,sec:f}};this.clearCanvas=function(b){var a,f,e=null;b.getContext&&
(e=b.getContext("2d"));e&&(a=b.offsetWidth,f=b.offsetHeight,e.clearRect(-(a/2),-(f/2),a,f))};this.updatePlaying=function(){var b=this._360data.showHMSTime?a.getTime(this.position,!0):parseInt(this.position/1E3,10),d=a.config.scaleArcWidth;this.bytesLoaded&&(this._360data.lastValues.bytesLoaded=this.bytesLoaded,this._360data.lastValues.bytesTotal=this.bytesTotal);this.position&&(this._360data.lastValues.position=this.position);this.durationEstimate&&(this._360data.lastValues.durationEstimate=this.durationEstimate);
a.drawSolidArc(this._360data.oCanvas,a.config.backgroundRingColor,this._360data.width,this._360data.radius*d,a.deg2rad(m),!1);a.drawSolidArc(this._360data.oCanvas,this._360data.metadata?a.config.loadRingColorMetadata:a.config.loadRingColor,this._360data.width,this._360data.radius*d,a.deg2rad(this._360data.lastValues.bytesLoaded/this._360data.lastValues.bytesTotal*m),0,!0);0!==this._360data.lastValues.position&&a.drawSolidArc(this._360data.oCanvas,this._360data.metadata?a.config.playRingColorMetadata:
a.config.playRingColor,this._360data.width,this._360data.radius*d,a.deg2rad(1===this._360data.didFinish?m:this._360data.lastValues.position/this._360data.lastValues.durationEstimate*m),0,!0);this._360data.metadata&&this._360data.metadata.events.whileplaying();b!==this._360data.lastTime&&(this._360data.lastTime=b,this._360data.oTiming.innerHTML=b);(this.instanceOptions.useWaveformData||this.instanceOptions.useEQData)&&v&&a.updateWaveform(this);a.config.useFavIcon&&a.vuMeter&&a.vuMeter.updateVU(this)};
this.updateWaveform=function(b){if(!a.config.useWaveformData&&!a.config.useEQData||!h.features.waveformData&&!h.features.eqData||!b.waveformData.left.length&&!b.eqData.length&&!b.peakData.left)return!1;var d,f,e,c,k,l,p,g,r,n=(b._360data.oCanvas.getContext("2d"),parseInt(b._360data.circleDiameter/2,10))/2;if(a.config.useWaveformData)for(e=a.config.waveformDataDownsample,e=Math.max(1,e),c=256/e,p=a.config.waveformDataOutside?1:a.config.waveformDataConstrain?.5:.565,n=a.config.waveformDataOutside?.7:
.75,g=a.deg2rad(360/c*a.config.waveformDataLineRatio),d=0;256>d;d+=e)k=a.deg2rad(d/c*1/e*360),l=k+g,f=b.waveformData.left[d],0>f&&a.config.waveformDataConstrain&&(f=Math.abs(f)),a.drawSolidArc(b._360data.oCanvas,a.config.waveformDataColor,b._360data.width*p*(2-a.config.scaleArcWidth),b._360data.radius*n*1.25*f,l,k,!0);if(a.config.useEQData)for(e=a.config.eqDataDownsample,e=Math.max(1,e),c=192,p=a.config.eqDataOutside?1:.565,f=a.config.eqDataOutside?-1:1,n=a.config.eqDataOutside?.5:.75,g=a.deg2rad(360/
(c/e)*a.config.eqDataLineRatio),r=a.deg2rad(1===b._360data.didFinish?360:b._360data.lastValues.position/b._360data.lastValues.durationEstimate*360),d=0;c>d;d+=e)k=a.deg2rad(d/c*360),l=k+g,a.drawSolidArc(b._360data.oCanvas,l>r?a.config.eqDataColor:a.config.playRingColor,b._360data.width*p,b._360data.radius*n*b.eqData.left[d]*f,l,k,!0);if(a.config.usePeakData&&!b._360data.animating){e=b.peakData.left||b.peakData.right;c=3;for(d=0;c>d;d++)e=e||b.eqData[d];b._360data.amplifier=a.config.useAmplifier?.9+
.1*e:1;b._360data.radiusMax=.175*b._360data.circleDiameter*b._360data.amplifier;b._360data.widthMax=.4*b._360data.circleDiameter*b._360data.amplifier;b._360data.radius=parseInt(b._360data.radiusMax*b._360data.amplifier,10);b._360data.width=parseInt(b._360data.widthMax*b._360data.amplifier,10)}};this.getUIHTML=function(b){return['\x3ccanvas class\x3d"sm2-canvas" width\x3d"'+b+'" height\x3d"'+b+'"\x3e\x3c/canvas\x3e',' \x3cspan class\x3d"sm2-360btn sm2-360btn-default"\x3e\x3c/span\x3e',' \x3cdiv class\x3d"sm2-timing'+
(navigator.userAgent.match(/safari/i)?" alignTweak":"")+'"\x3e\x3c/div\x3e',' \x3cdiv class\x3d"sm2-cover"\x3e\x3c/div\x3e']};this.uiTest=function(b){var d,c,e,k,l,h,p,g,r,n=document.createElement("div");return n.className="sm2-360ui",d=document.createElement("div"),d.className="ui360"+(b?" "+b:""),c=d.appendChild(n.cloneNode(!0)),d.style.position="absolute",d.style.left="-9999px",e=document.body.appendChild(d),k=c.offsetWidth*A,l=a.getUIHTML(k),c.innerHTML=l[1]+l[2]+l[3],h=parseInt(k,10),p=parseInt(h/
2,10),r=a.getElementsByClassName("sm2-timing","div",e)[0],g=parseInt(a.getStyle(r,"font-size"),10),isNaN(g)&&(g=null),d.parentNode.removeChild(d),{circleDiameter:h,circleRadius:p,fontSizeMax:g}};this.init=function(){h._writeDebug("threeSixtyPlayer.init()");var b,c,f,e,k,l,r,n,m,v,x,C,w,B;m=a.getElementsByClassName("ui360","div");var t=[],z=!1,y=0;b=0;for(c=m.length;c>b;b++)t.push(m[b].getElementsByTagName("a")[0]),m[b].style.backgroundImage="none";a.oUITemplate=document.createElement("div");a.oUITemplate.className=
"sm2-360ui";a.oUITemplateVis=document.createElement("div");a.oUITemplateVis.className="sm2-360ui";m=a.uiTest();a.config.circleDiameter=m.circleDiameter;a.config.circleRadius=m.circleRadius;v=a.uiTest("ui360-vis");a.config.fontSizeMax=v.fontSizeMax;a.oUITemplate.innerHTML=a.getUIHTML(a.config.circleDiameter).join("");a.oUITemplateVis.innerHTML=a.getUIHTML(v.circleDiameter).join("");b=0;for(c=t.length;c>b;b++)!h.canPlayLink(t[b])||a.hasClass(t[b],a.excludeClass)||a.hasClass(t[b],a.css.sDefault)||(a.addClass(t[b],
a.css.sDefault),a.links[y]=t[b],a.indexByURL[t[b].href]=y,y++,z=a.hasClass(t[b].parentNode,"ui360-vis"),r=(z?v:m).circleDiameter,n=(z?v:m).circleRadius,x=t[b].parentNode.insertBefore((z?a.oUITemplateVis:a.oUITemplate).cloneNode(!0),t[b]),u&&"undefined"!=typeof g.G_vmlCanvasManager?(w=document.createElement("canvas"),w.className="sm2-canvas",B="sm2_canvas_"+b+(new Date).getTime(),w.id=B,w.width=r,w.height=r,x.appendChild(w),g.G_vmlCanvasManager.initElement(w),e=document.getElementById(B),f=e.parentNode.getElementsByTagName("canvas"),
1<f.length&&(e=f[f.length-1])):e=t[b].parentNode.getElementsByTagName("canvas")[0],1<A&&a.addClass(e,"hi-dpi"),l=a.getElementsByClassName("sm2-cover","div",t[b].parentNode)[0],C=t[b].parentNode.getElementsByTagName("span")[0],a.addEventHandler(C,"click",a.buttonClick),p?a.addEventHandler(l,"touchstart",a.mouseDown):a.addEventHandler(l,"mousedown",a.mouseDown),k=e.getContext("2d"),k.translate(n,n),k.rotate(a.deg2rad(-90)));0<y&&(a.addEventHandler(document,"click",a.handleClick),a.config.autoPlay&&
a.handleClick({target:a.links[0],preventDefault:function(){}}));h._writeDebug("threeSixtyPlayer.init(): Found "+y+" relevant items.");a.config.useFavIcon&&"undefined"!=typeof this.VUMeter&&(this.vuMeter=new this.VUMeter(this))}}x.prototype.VUMeter=function(a){var c=this,h=document.getElementsByTagName("head")[0],g=navigator.userAgent.match(/opera/i),u=navigator.userAgent.match(/firefox/i);this.vuMeterData=[];this.vuDataCanvas=null;this.setPageIcon=function(c){if(!a.config.useFavIcon||!a.config.usePeakData||
!c)return!1;var k=document.getElementById("sm2-favicon");k&&(h.removeChild(k),k=null);k||(k=document.createElement("link"),k.id="sm2-favicon",k.rel="shortcut icon",k.type="image/png",k.href=c,document.getElementsByTagName("head")[0].appendChild(k))};this.resetPageIcon=function(){if(!a.config.useFavIcon)return!1;var c=document.getElementById("favicon");c&&(c.href="/favicon.ico")};this.updateVU=function(l){9<=soundManager.flashVersion&&a.config.useFavIcon&&a.config.usePeakData&&c.setPageIcon(c.vuMeterData[parseInt(16*
l.peakData.left,10)][parseInt(16*l.peakData.right,10)])};this.createVUData=function(){var a=0,k=0,h=c.vuDataCanvas.getContext("2d"),g=h.createLinearGradient(0,16,0,0),n=h.createLinearGradient(0,16,0,0);g.addColorStop(0,"rgb(0,192,0)");g.addColorStop(.3,"rgb(0,255,0)");g.addColorStop(.625,"rgb(255,255,0)");g.addColorStop(.85,"rgb(255,0,0)");n.addColorStop(0,"rgba(0,0,0,0.2)");n.addColorStop(1,"rgba(0,0,0,0.5)");for(a=0;16>a;a++)c.vuMeterData[a]=[];for(a=0;16>a;a++)for(k=0;16>k;k++)c.vuDataCanvas.setAttribute("width",
16),c.vuDataCanvas.setAttribute("height",16),h.fillStyle=n,h.fillRect(0,0,7,15),h.fillRect(8,0,7,15),h.fillStyle=g,h.fillRect(0,15-a,7,16-(16-a)),h.fillRect(8,15-k,7,16-(16-k)),h.clearRect(0,3,16,1),h.clearRect(0,7,16,1),h.clearRect(0,11,16,1),c.vuMeterData[a][k]=c.vuDataCanvas.toDataURL("image/png")};this.testCanvas=function(){var a=document.createElement("canvas"),c=null;if(!a||"undefined"==typeof a.getContext||(c=a.getContext("2d"),!c||"function"!=typeof a.toDataURL))return null;try{a.toDataURL("image/png")}catch(h){return null}return a};
this.init=function(){a.config.useFavIcon&&(c.vuDataCanvas=c.testCanvas(),c.vuDataCanvas&&(u||g)?c.createVUData():a.config.useFavIcon=!1)};this.init()};x.prototype.Metadata=function(a,c){soundManager._wD("Metadata()");var h,g=this,u=a._360data.oUI360,l=u.getElementsByTagName("ul")[0].getElementsByTagName("li");navigator.userAgent.match(/firefox/i);this.lastWPExec=0;this.refreshInterval=250;this.totalTime=0;this.events={whileplaying:function(){var k,h,p=a._360data.width,l=a._360data.radius,m=a.durationEstimate||
1E3*g.totalTime,u=null;k=0;for(h=g.data.length;h>k;k++)u=0===k%2,c.drawSolidArc(a._360data.oCanvas,u?c.config.segmentRingColorAlt:c.config.segmentRingColor,p,l/2,c.deg2rad(g.data[k].endTimeMS/m*360),c.deg2rad((g.data[k].startTimeMS||1)/m*360),!0);k=new Date;k-g.lastWPExec>g.refreshInterval&&(g.refresh(),g.lastWPExec=k)}};this.refresh=function(){var c,h,g=null,l=a.position,m=a._360data.metadata.data;c=0;for(h=m.length;h>c;c++)if(l>=m[c].startTimeMS&&l<=m[c].endTimeMS){g=c;break}g!==m.currentItem&&
g<m.length&&(a._360data.oLink.innerHTML=m.mainTitle+' \x3cspan class\x3d"metadata"\x3e\x3cspan class\x3d"sm2_divider"\x3e | \x3c/span\x3e\x3cspan class\x3d"sm2_metadata"\x3e'+m[g].title+"\x3c/span\x3e\x3c/span\x3e",m.currentItem=g)};this.strToTime=function(a){var c=a.split(":"),g=0;for(a=c.length;a--;)g+=parseInt(c[a],10)*Math.pow(60,c.length-1-a);return g};this.data=[];this.data.givenDuration=null;this.data.currentItem=null;this.data.mainTitle=a._360data.oLink.innerHTML;for(h=0;h<l.length;h++)this.data[h]=
{o:null,title:l[h].getElementsByTagName("p")[0].innerHTML,startTime:l[h].getElementsByTagName("span")[0].innerHTML,startSeconds:g.strToTime(l[h].getElementsByTagName("span")[0].innerHTML.replace(/[()]/g,"")),duration:0,durationMS:null,startTimeMS:null,endTimeMS:null,oNote:null};h=c.getElementsByClassName("duration","div",u);this.data.givenDuration=h.length?1E3*g.strToTime(h[0].innerHTML):0;for(h=0;h<this.data.length;h++)this.data[h].duration=parseInt(this.data[h+1]?this.data[h+1].startSeconds:(g.data.givenDuration?
g.data.givenDuration:a.durationEstimate)/1E3,10)-this.data[h].startSeconds,this.data[h].startTimeMS=1E3*this.data[h].startSeconds,this.data[h].durationMS=1E3*this.data[h].duration,this.data[h].endTimeMS=this.data[h].startTimeMS+this.data[h].durationMS,this.totalTime+=this.data[h].duration};navigator.userAgent.match(/webkit/i)&&navigator.userAgent.match(/mobile/i)&&soundManager.setup({useHTML5Audio:!0});soundManager.setup({html5PollingInterval:50,debugMode:g.location.href.match(/debug=1/i),consoleOnly:!0,
flashVersion:9,useHighPerformance:!0});soundManager.debugMode&&g.setInterval(function(){var a=g.threeSixtyPlayer;a&&a.lastSound&&a.lastSound._360data.fps&&"undefined"==typeof g.isHome&&(soundManager._writeDebug("fps: ~"+a.lastSound._360data.fps),a.lastSound._360data.fps=0)},1E3);g.ThreeSixtyPlayer=x}(window);threeSixtyPlayer=new ThreeSixtyPlayer;soundManager.onready(threeSixtyPlayer.init);